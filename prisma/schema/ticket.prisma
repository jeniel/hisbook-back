model TicketTransaction {
    id                String          @id @default(uuid())
    title             String?
    description       String?         @db.Text()
    ticketNumber      String?         @unique @map("ticket_number")
    status            TicketStatus?   @default(OPEN)
    priority          TicketPriority? @default(LOW)
    departmentFrom    String?         @map("department_from")
    departmentTo      String?         @map("department_to")
    ticketCreatedBy   String?         @map("ticket_created_by")
    ticketAssignedTo  String?         @map("ticket_assigned_to")
    ticketAssignedBy  String?         @map("ticket_assigned_by")
    // RELATION
    comment           Comment[]
    createdByProfile  Profile?        @relation("TicketCreatedBy", fields: [ticketCreatedBy], references: [id])
    assignedToProfile Profile?        @relation("TicketAssignedTo", fields: [ticketAssignedTo], references: [id])
    assignedByProfile Profile?        @relation("TicketAssignedBy", fields: [ticketAssignedBy], references: [id])

    fromDepartment Department? @relation("DepartmentFrom", fields: [departmentFrom], references: [id])
    toDepartment   Department? @relation("DepartmentTo", fields: [departmentTo], references: [id])

    ticketCategory   TicketCategory? @relation(fields: [ticketCategoryId], references: [id])
    ticketCategoryId String?         @map("ticket_category_id")
    // STAMP
    createdAt        DateTime        @default(now()) @map("created_at") @db.Timestamptz()
    createdBy        String?         @map("created_by")
    updatedAt        DateTime        @default(now()) @updatedAt @map("updated_at") @db.Timestamptz()
    updatedBy        String?         @map("updated_by")

    @@map("ticket_transaction")
    @@schema("ticketing")
}

// model AgentTransaction {
//     id                  String             @id @default(uuid())
//     // RELATION
//     ticket              TicketTransaction? @relation(fields: [ticketTransactionId], references: [id])
//     ticketTransactionId String?            @map("ticket_transaction_id")
//     profile             Profile?           @relation(fields: [profileId], references: [id])
//     profileId           String?            @map("profile_id")

//     @@map("agent_transaction")
//     @@schema("ticketing")
// }

model Comment {
    id        String            @id @default(uuid())
    content   String            @db.Text()
    // RELATION
    ticket    TicketTransaction @relation(fields: [ticketId], references: [id])
    ticketId  String            @map("ticket_id")
    profile   Profile           @relation(fields: [profileId], references: [id])
    profileId String            @map("profile_id")
    // STAMP
    createdAt DateTime          @default(now()) @map("created_at") @db.Timestamptz()
    createdBy String?           @map("created_by")
    updatedAt DateTime          @default(now()) @updatedAt @map("updated_at") @db.Timestamptz()
    updatedBy String?           @map("updated_by")

    @@map("comment")
    @@schema("ticketing")
}

model TicketCategory {
    id                String              @id @default(uuid())
    name              String
    description       String?
    // RELATION
    ticketTransaction TicketTransaction[]

    @@map("ticket_category")
    @@schema("ticketing")
}

model TicketSubCategory {
    id          String  @id @default(uuid())
    name        String
    description String?
    // RELATION

    @@map("ticket_sub_category")
    @@schema("ticketing")
}

enum TicketStatus {
    OPEN
    IN_PROGRESS
    RESOLVED
    CLOSED

    @@map("ticket_status")
    @@schema("ticketing")
}

enum TicketPriority {
    LOW
    MEDIUM
    HIGH
    CRITICAL

    @@map("ticket_priority")
    @@schema("ticketing")
}
