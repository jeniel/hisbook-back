model User {
  id                 String  @id @default(uuid())
  /// @Validator.@IsEmail()
  email              String  @unique
  username           String  @unique
  /// @HideField()
  hashedPassword     String  @map("hashed_password")
  hashedRefreshToken String? @map("hashed_refresh_token")

  // Relations
  role               Role[]               @default([USER])
  profile            Profile?
  posts              Posts[]
  MissedLogoutTicket MissedLogoutTicket[] @relation("CreatedBy")
  auditLogs         AuditLog[]

  departmentId String?     @map("department_id")
  department   Department? @relation(fields: [departmentId], references: [id])

  @@map("user")
  @@schema("global")
}

model Profile {
  id         String    @id @default(uuid())
  firstName  String?   @map("first_name")
  middleName String?   @map("middle_name")
  lastName   String?   @map("last_name")
  birthDate  DateTime? @map("birth_date")
  gender     Gender?   @map("gender")
  title      String?   @map("title")
  address    String?
  contact    String?
  avatar     String?
  employeeID Int?      @unique @map("employee_id")
  createdAt  DateTime  @default(now()) @map("created_at")
  updatedAt  DateTime  @default(now()) @updatedAt @map("updated_at")

  // Relations
  userId String? @unique @map("user_id")
  user   User?   @relation(fields: [userId], references: [id])

  @@map("profile")
  @@schema("global")
}

model Department {
  id          String @id @default(uuid())
  name        String @unique
  description String

  // Relations
  profiles User[]

  @@map("department")
  @@schema("global")
}

enum Role {
  USER
  ADMIN

  @@schema("global")
}

enum Gender {
  Male
  Female
  Others

  @@schema("global")
}

model Posts {
  id         String   @id @default(uuid())
  content    String
  datePosted DateTime @default(now())
  images     String[]   // store image URLs directly
  userId     String?
  user       User?   @relation(fields: [userId], references: [id])

  @@map("posts")
  @@schema("global")
}
model MissedLogoutTicket {
  id          String    @id @default(uuid())
  subject     String?   // Subject of the Ticket
  missedAt    DateTime? // Date and Time
  floor       String?   // Example: "B1 Biometrics"
  screenshot  String?   // Screenshot URL or path
  status      Status?   @default(Pending) // Status of the Ticket
  remarks     String?   // Any additional information
  updatedBy   String?   // Who last updated the ticket
  createdAt   DateTime  @default(now()) @map("created_at")

  createdById String?
  createdBy   User?     @relation("CreatedBy", fields: [createdById], references: [id])

  auditLogs   AuditLog[]

  @@map("missedlogoutticket")
  @@schema("global")
}

model AuditLog {
  id          String    @id @default(uuid())
  action      String?    // Description of action (ex: "Updated status to Resolved")
  timestamp   DateTime  @default(now()) // Timestamp of the action
  updatedBy   String?   // User's name or identifier
  userId      String?   // ID of the user who performed the action
  user        User?     @relation(fields: [userId], references: [id])

  ticketId    String?
  ticket      MissedLogoutTicket? @relation(fields: [ticketId], references: [id])

  @@map("auditlog")
  @@schema("global")
}

enum Status {
  Pending
  Approvedgita
  Completed

  @@schema("global")
}
